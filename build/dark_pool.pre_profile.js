function weight(x){ return 2097152 * x.network_depth + 256 * x.total_gates + 256 * x.network_size + x.preprocess_weight;}var pre_profile = { 'code':
{"source_file":"use arcis::*;\n\n#[encrypted]\nmod dark_pool {\n    use arcis::*;\n\n    pub struct OrderData {\n        pub price: u64,\n        pub volume: u64,\n        pub side: u64,        // 0 = Buy (买), 1 = Sell (卖)\n        pub min_exec_qty: u64 // 最小执行数量 (保护隐私，防止微量钓鱼)\n    }\n\n    pub struct TradeResult {\n        pub is_executed: u64, // 1 = Success, 0 = Fail\n        pub exec_price: u64,  // 执行价格\n        pub exec_volume: u64, // 执行数量\n    }\n\n    /// 暗池核心撮合指令\n    /// 逻辑：验证方向、价格交叉、最小数量约束，并计算中间价\n    #[instruction]\n    pub fn execute_dark_match(\n        maker_ctxt: Enc<Shared, OrderData>,\n        taker_ctxt: Enc<Shared, OrderData>\n    ) -> Enc<Shared, TradeResult> {\n        let maker = maker_ctxt.to_arcis();\n        let taker = taker_ctxt.to_arcis();\n\n        // 1. 验证方向：必须是一买一卖 (0+1=1)\n        // 如果是 0+0 或 1+1，则为无效匹配\n        let valid_sides = (maker.side + taker.side) == 1;\n\n        // 2. 识别买方和卖方\n        // 使用 Mux (Multiplexer) 动态分配，无需暴露谁是 Maker\n        let is_maker_buy = maker.side == 0;\n        \n        let buy_price = if is_maker_buy { maker.price } else { taker.price };\n        let sell_price = if is_maker_buy { taker.price } else { maker.price };\n        \n        // 3. 价格交叉检查：买价必须 >= 卖价\n        let price_match = buy_price >= sell_price;\n\n        // 4. 计算最大可成交量 (取两者较小值)\n        let exec_vol = if maker.volume < taker.volume { maker.volume } else { taker.volume };\n\n        // 5. 最小执行数量检查 (AON - All Or None 变体)\n        // 只有当成交量满足双方的“最小门槛”时才成交，防止隐私泄露\n        let min_fill_satisfied = (exec_vol >= maker.min_exec_qty) && (exec_vol >= taker.min_exec_qty);\n\n        // 6. 最终判定\n        let can_trade = valid_sides && price_match && min_fill_satisfied;\n\n        // 7. 计算公平执行价 (中间价)\n        let mid_price = (buy_price + sell_price) / 2;\n\n        let result = if can_trade {\n            TradeResult {\n                is_executed: 1,\n                exec_price: mid_price,\n                exec_volume: exec_vol,\n            }\n        } else {\n            TradeResult {\n                is_executed: 0,\n                exec_price: 0,\n                exec_volume: 0,\n            }\n        };\n\n        // 结果加密返回给 Maker (挂单方)\n        maker_ctxt.owner.from_arcis(result)\n    }\n}","code":[{"code":"self.owner","region":"Unknown"},{"code":"self.data","region":"Unknown"},{"code":"Self :: __arcis_inner(self.owner, self.data)","region":"Unknown"},{"code":"let maker = maker_ctxt.to_arcis();","region":{"Known":[{"line":26,"column":8},{"line":26,"column":42}]}},{"code":"let taker = taker_ctxt.to_arcis();","region":{"Known":[{"line":27,"column":8},{"line":27,"column":42}]}},{"code":"maker.side + taker.side","region":{"Known":[{"line":31,"column":27},{"line":31,"column":50}]}},{"code":"let valid_sides = (maker.side + taker.side) == 1;","region":{"Known":[{"line":31,"column":8},{"line":31,"column":57}]}},{"code":"let is_maker_buy = maker.side == 0;","region":{"Known":[{"line":35,"column":8},{"line":35,"column":43}]}},{"code":"is_maker_buy","region":{"Known":[{"line":37,"column":27},{"line":37,"column":39}]}},{"code":"taker.price","region":{"Known":[{"line":37,"column":63},{"line":37,"column":74}]}},{"code":"maker.price","region":{"Known":[{"line":37,"column":42},{"line":37,"column":53}]}},{"code":"let buy_price = if is_maker_buy { maker.price } else { taker.price };","region":{"Known":[{"line":37,"column":8},{"line":37,"column":77}]}},{"code":"is_maker_buy","region":{"Known":[{"line":38,"column":28},{"line":38,"column":40}]}},{"code":"maker.price","region":{"Known":[{"line":38,"column":64},{"line":38,"column":75}]}},{"code":"taker.price","region":{"Known":[{"line":38,"column":43},{"line":38,"column":54}]}},{"code":"let sell_price = if is_maker_buy { taker.price } else { maker.price };","region":{"Known":[{"line":38,"column":8},{"line":38,"column":78}]}},{"code":"let price_match = buy_price >= sell_price;","region":{"Known":[{"line":41,"column":8},{"line":41,"column":50}]}},{"code":"maker.volume < taker.volume","region":{"Known":[{"line":44,"column":26},{"line":44,"column":53}]}},{"code":"taker.volume","region":{"Known":[{"line":44,"column":78},{"line":44,"column":90}]}},{"code":"maker.volume","region":{"Known":[{"line":44,"column":56},{"line":44,"column":68}]}},{"code":"let exec_vol = if maker.volume < taker.volume { maker.volume } else\n{ taker.volume };","region":{"Known":[{"line":44,"column":8},{"line":44,"column":93}]}},{"code":"exec_vol >= maker.min_exec_qty","region":{"Known":[{"line":48,"column":34},{"line":48,"column":64}]}},{"code":"exec_vol >= taker.min_exec_qty","region":{"Known":[{"line":48,"column":70},{"line":48,"column":100}]}},{"code":"let min_fill_satisfied = (exec_vol >= maker.min_exec_qty) &&\n(exec_vol >= taker.min_exec_qty);","region":{"Known":[{"line":48,"column":8},{"line":48,"column":102}]}},{"code":"let can_trade = valid_sides && price_match && min_fill_satisfied;","region":{"Known":[{"line":51,"column":8},{"line":51,"column":73}]}},{"code":"buy_price + sell_price","region":{"Known":[{"line":54,"column":25},{"line":54,"column":47}]}},{"code":"let mid_price = (buy_price + sell_price) / 2;","region":{"Known":[{"line":54,"column":8},{"line":54,"column":53}]}},{"code":"can_trade","region":{"Known":[{"line":56,"column":24},{"line":56,"column":33}]}},{"code":"0","region":{"Known":[{"line":64,"column":29},{"line":64,"column":30}]}},{"code":"0","region":{"Known":[{"line":65,"column":28},{"line":65,"column":29}]}},{"code":"0","region":{"Known":[{"line":66,"column":29},{"line":66,"column":30}]}},{"code":"TradeResult { is_executed : 0, exec_price : 0, exec_volume : 0, }","region":{"Known":[{"line":63,"column":12},{"line":67,"column":13}]}},{"code":"1","region":{"Known":[{"line":58,"column":29},{"line":58,"column":30}]}},{"code":"mid_price","region":{"Known":[{"line":59,"column":28},{"line":59,"column":37}]}},{"code":"exec_vol","region":{"Known":[{"line":60,"column":29},{"line":60,"column":37}]}},{"code":"TradeResult\n{ is_executed : 1, exec_price : mid_price, exec_volume : exec_vol, }","region":{"Known":[{"line":57,"column":12},{"line":61,"column":13}]}},{"code":"let result = if can_trade\n{\n    TradeResult\n    { is_executed : 1, exec_price : mid_price, exec_volume : exec_vol, }\n} else { TradeResult { is_executed : 0, exec_price : 0, exec_volume : 0, } };","region":{"Known":[{"line":56,"column":8},{"line":68,"column":10}]}},{"code":"result","region":{"Known":[{"line":71,"column":36},{"line":71,"column":42}]}},{"code":"1","region":"Unknown"},{"code":"fn inner < T > (a : T, b : T) -> T { ((a + b) as ArcisField) as T }","region":"Unknown"},{"code":"self","region":"Unknown"},{"code":"other","region":"Unknown"},{"code":"a + b","region":"Unknown"},{"code":"(a + b) as ArcisField","region":"Unknown"},{"code":"((a + b) as ArcisField) as T","region":"Unknown"},{"code":"inner(self, other)","region":"Unknown"},{"code":"self.nonce = self.nonce.wrapping_add(1);","region":"Unknown"},{"code":"self","region":"Unknown"},{"code":"a","region":"Unknown"},{"code":"a","region":"Unknown"},{"code":"self.from_arcis_inner(a)","region":"Unknown"},{"code":"a","region":"Unknown"},{"code":"let phantom = [a; 0];","region":"Unknown"},{"code":"data","region":"Unknown"},{"code":"phantom","region":"Unknown"},{"code":"let data = EncData { data, phantom };","region":"Unknown"},{"code":"owner","region":"Unknown"},{"code":"data","region":"Unknown"},{"code":"Self { owner, data }","region":"Unknown"},{"code":"Enc :: new_inner(self, a, self.from_arcis_inner(a))","region":"Unknown"},{"code":"maker_ctxt.owner.from_arcis(result)","region":{"Known":[{"line":71,"column":8},{"line":71,"column":43}]}}]}
, 'instructions':
{"execute_dark_match":{"profilees":[{"code_idx":0,"before_size_id":0,"after_size_id":0},{"code_idx":1,"before_size_id":0,"after_size_id":1},{"code_idx":2,"before_size_id":0,"after_size_id":2},{"code_idx":3,"before_size_id":0,"after_size_id":2},{"code_idx":0,"before_size_id":2,"after_size_id":2},{"code_idx":1,"before_size_id":2,"after_size_id":2},{"code_idx":2,"before_size_id":2,"after_size_id":3},{"code_idx":4,"before_size_id":2,"after_size_id":3},{"code_idx":5,"before_size_id":3,"after_size_id":4},{"code_idx":6,"before_size_id":3,"after_size_id":5},{"code_idx":7,"before_size_id":5,"after_size_id":6},{"code_idx":8,"before_size_id":6,"after_size_id":6},{"code_idx":9,"before_size_id":6,"after_size_id":6},{"code_idx":10,"before_size_id":6,"after_size_id":6},{"code_idx":11,"before_size_id":6,"after_size_id":7},{"code_idx":12,"before_size_id":7,"after_size_id":7},{"code_idx":13,"before_size_id":7,"after_size_id":7},{"code_idx":14,"before_size_id":7,"after_size_id":7},{"code_idx":15,"before_size_id":7,"after_size_id":8},{"code_idx":16,"before_size_id":8,"after_size_id":9},{"code_idx":17,"before_size_id":9,"after_size_id":10},{"code_idx":18,"before_size_id":10,"after_size_id":10},{"code_idx":19,"before_size_id":10,"after_size_id":10},{"code_idx":20,"before_size_id":9,"after_size_id":11},{"code_idx":21,"before_size_id":11,"after_size_id":12},{"code_idx":22,"before_size_id":12,"after_size_id":13},{"code_idx":23,"before_size_id":11,"after_size_id":14},{"code_idx":24,"before_size_id":14,"after_size_id":15},{"code_idx":25,"before_size_id":15,"after_size_id":16},{"code_idx":26,"before_size_id":15,"after_size_id":17},{"code_idx":27,"before_size_id":17,"after_size_id":17},{"code_idx":28,"before_size_id":17,"after_size_id":17},{"code_idx":29,"before_size_id":17,"after_size_id":17},{"code_idx":30,"before_size_id":17,"after_size_id":17},{"code_idx":31,"before_size_id":17,"after_size_id":17},{"code_idx":32,"before_size_id":17,"after_size_id":17},{"code_idx":33,"before_size_id":17,"after_size_id":17},{"code_idx":34,"before_size_id":17,"after_size_id":17},{"code_idx":35,"before_size_id":17,"after_size_id":17},{"code_idx":36,"before_size_id":17,"after_size_id":18},{"code_idx":37,"before_size_id":18,"after_size_id":18},{"code_idx":38,"before_size_id":18,"after_size_id":18},{"code_idx":39,"before_size_id":18,"after_size_id":18},{"code_idx":40,"before_size_id":18,"after_size_id":18},{"code_idx":41,"before_size_id":18,"after_size_id":18},{"code_idx":42,"before_size_id":18,"after_size_id":19},{"code_idx":43,"before_size_id":18,"after_size_id":19},{"code_idx":44,"before_size_id":18,"after_size_id":20},{"code_idx":45,"before_size_id":18,"after_size_id":20},{"code_idx":46,"before_size_id":18,"after_size_id":20},{"code_idx":47,"before_size_id":20,"after_size_id":20},{"code_idx":48,"before_size_id":20,"after_size_id":20},{"code_idx":49,"before_size_id":20,"after_size_id":20},{"code_idx":50,"before_size_id":20,"after_size_id":21},{"code_idx":51,"before_size_id":21,"after_size_id":21},{"code_idx":52,"before_size_id":21,"after_size_id":21},{"code_idx":53,"before_size_id":21,"after_size_id":21},{"code_idx":54,"before_size_id":21,"after_size_id":21},{"code_idx":55,"before_size_id":21,"after_size_id":21},{"code_idx":56,"before_size_id":21,"after_size_id":21},{"code_idx":57,"before_size_id":21,"after_size_id":21},{"code_idx":58,"before_size_id":21,"after_size_id":21},{"code_idx":59,"before_size_id":20,"after_size_id":21},{"code_idx":60,"before_size_id":18,"after_size_id":21}]}}
, 'instruction_locations':
{"execute_dark_match":{"Known":[{"line":21,"column":4},{"line":21,"column":18}]}}
};
